Assignment 2 â€“ Calculate Grades for 10 Students Using Cursor

CREATE TABLE Students (
    roll_no INT PRIMARY KEY,
    student_name VARCHAR(50),
    marks INT,
    grade CHAR(2)
);

-- Insert sample 10 students
INSERT INTO Students (roll_no, student_name, marks) VALUES
(1, 'Amit', 85),
(2, 'Sneha', 92),
(3, 'Rahul', 78),
(4, 'Priya', 88),
(5, 'Karan', 95),
(6, 'Rohit', 65),
(7, 'Sonam', 55),
(8, 'Shruti', 45),
(9, 'Neha', 72),
(10, 'Aakash', 81);

DELIMITER //

CREATE PROCEDURE CalculateGrades()
BEGIN
    DECLARE done INT DEFAULT 0;
    DECLARE v_roll INT;
    DECLARE v_name VARCHAR(50);
    DECLARE v_marks INT;
    DECLARE v_grade CHAR(2);

    -- Cursor to fetch all students
    DECLARE cur_students CURSOR FOR
        SELECT roll_no, student_name, marks FROM Students;

    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

    OPEN cur_students;

    read_loop: LOOP
        FETCH cur_students INTO v_roll, v_name, v_marks;
        IF done THEN
            LEAVE read_loop;
        END IF;

        -- Calculate grade
        IF v_marks >= 90 THEN
            SET v_grade = 'A+';
        ELSEIF v_marks >= 80 THEN
            SET v_grade = 'A';
        ELSEIF v_marks >= 70 THEN
            SET v_grade = 'B';
        ELSEIF v_marks >= 60 THEN
            SET v_grade = 'C';
        ELSEIF v_marks >= 50 THEN
            SET v_grade = 'D';
        ELSE
            SET v_grade = 'F';
        END IF;

        -- Update grade in table
        UPDATE Students SET grade = v_grade WHERE roll_no = v_roll;
    END LOOP;

    CLOSE cur_students;

    -- Display students with grades
    SELECT * FROM Students ORDER BY roll_no;
END //

DELIMITER ;

CALL CalculateGrades();

