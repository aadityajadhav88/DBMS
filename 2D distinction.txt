CREATE DATABASE StudentDB;
USE StudentDB;

CREATE TABLE Stud_Marks (
    Roll INT PRIMARY KEY AUTO_INCREMENT,
    Name VARCHAR(50),
    Total_Marks INT
);

CREATE TABLE Result (
    Roll INT,
    Name VARCHAR(50),
    Class VARCHAR(30)
);

INSERT INTO Stud_Marks (Name, Total_Marks) VALUES
('Amit', 1450),
('Sneha', 980),
('Rahul', 860),
('Priya', 820),
('Karan', 700);

DELIMITER //
CREATE PROCEDURE proc_Grade()
BEGIN
    DECLARE done INT DEFAULT 0;
    DECLARE v_roll INT;
    DECLARE v_name VARCHAR(50);
    DECLARE v_marks INT;
    DECLARE v_class VARCHAR(30);
    DECLARE cur CURSOR FOR SELECT Roll, Name, Total_Marks FROM Stud_Marks;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

    OPEN cur;
    read_loop: LOOP
        FETCH cur INTO v_roll, v_name, v_marks;
        IF done THEN
            LEAVE read_loop;
        END IF;

        IF v_marks BETWEEN 990 AND 1500 THEN
            SET v_class = 'Distinction';
        ELSEIF v_marks BETWEEN 900 AND 989 THEN
            SET v_class = 'First Class';
        ELSEIF v_marks BETWEEN 825 AND 899 THEN
            SET v_class = 'Higher Second Class';
        ELSE
            SET v_class = 'Pass/Fail';
        END IF;

        INSERT INTO Result VALUES (v_roll, v_name, v_class);
    END LOOP;
    CLOSE cur;
END //
DELIMITER ;

CALL proc_Grade();

SELECT * FROM Result;
